<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>育成ゲーム</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; }
        canvas { display: block; margin: 0 auto; background: #f0f0f0; }
        #scoreboard { text-align: center; margin: 10px; }
    </style>
</head>
<body>
    <div id="scoreboard">Score: 0 | Level: 1</div>
    <canvas id="gameCanvas" width="800" height="600"></canvas>
    <audio id="backgroundMusic" src="background.mp3" loop></audio>
    <audio id="collisionSound" src="collision.mp3"></audio>
    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        const images = {
            vista: new Image(),
            longhorn: new Image()
        };
        images.vista.src = 'vista.png';
        images.longhorn.src = 'longhorn.png';

        const backgroundMusic = document.getElementById('backgroundMusic');
        const collisionSound = document.getElementById('collisionSound');

        let character = {
            x: 100,
            y: 100,
            width: 50,
            height: 50,
            image: images.vista,
            dx: 2,
            dy: 2
        };

        let score = 0;
        let level = 1;
        let levelThreshold = 10;

        const obstacles = [
            { x: 200, y: 200, width: 50, height: 50, color: 'red' },
            { x: 400, y: 300, width: 50, height: 50, color: 'green' }
        ];

        function drawCharacter() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawHouse(); // 家を描画する
            ctx.drawImage(character.image, character.x, character.y, character.width, character.height);
        }

        function drawHouse() {
            // 家の枠
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 3;
            ctx.strokeRect(300, 400, 100, 100); // 家の枠
            ctx.fillStyle = '#f5deb3'; // ベージュ色
            ctx.fillRect(300, 400, 100, 100); // 家の中を塗りつぶす

            // 屋根
            ctx.beginPath();
            ctx.moveTo(290, 400);
            ctx.lineTo(350, 350);
            ctx.lineTo(410, 400);
            ctx.closePath();
            ctx.stroke();
            ctx.fillStyle = '#d2691e'; // 屋根の色
            ctx.fill();
        }

        function drawObstacles() {
            obstacles.forEach(obstacle => {
                ctx.fillStyle = obstacle.color;
                ctx.fillRect(obstacle.x, obstacle.y, obstacle.width, obstacle.height);
            });
        }

        function updateScore() {
            score += 1;
            document.getElementById('scoreboard').textContent = `Score: ${score} | Level: ${level}`;
        }

        function updateLevel() {
            if (score >= level * levelThreshold) {
                level += 1;
                character.dx *= 1.1;
                character.dy *= 1.1;
                levelThreshold *= 1.5;
                console.log(`Level Up! Level: ${level}`);
            }
        }

        function checkCollision() {
            obstacles.forEach(obstacle => {
                if (character.x < obstacle.x + obstacle.width &&
                    character.x + character.width > obstacle.x &&
                    character.y < obstacle.y + obstacle.height &&
                    character.y + character.height > obstacle.y) {
                    character.dx *= -1;
                    character.dy *= -1;
                    playCollisionSound();
                }
            });
        }

        function playCollisionSound() {
            collisionSound.play();
        }

        function gameLoop() {
            character.x += character.dx;
            character.y += character.dy;

            if (character.x < 0 || character.x + character.width > canvas.width) {
                character.dx *= -1;
                character.image = (character.image === images.vista) ? images.longhorn : images.vista;
                updateScore();
            }
            if (character.y < 0 || character.y + character.height > canvas.height) {
                character.dy *= -1;
                character.image = (character.image === images.vista) ? images.longhorn : images.vista;
                updateScore();
            }

            drawCharacter();
            drawObstacles();
            checkCollision();
            updateLevel();
            requestAnimationFrame(gameLoop);
        }

        images.vista.onload = () => {
            images.longhorn.onload = () => {
                backgroundMusic.play();
                gameLoop();
            };
        };
    </script>
</body>
</html>
